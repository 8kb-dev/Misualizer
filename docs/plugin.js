parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"dEOc":[function(require,module,exports) {
function r(r){if(Array.isArray(r))return r}module.exports=r;
},{}],"RonT":[function(require,module,exports) {
function r(r,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var e=[],n=!0,o=!1,l=void 0;try{for(var i,u=r[Symbol.iterator]();!(n=(i=u.next()).done)&&(e.push(i.value),!t||e.length!==t);n=!0);}catch(a){o=!0,l=a}finally{try{n||null==u.return||u.return()}finally{if(o)throw l}}return e}}module.exports=r;
},{}],"LGpM":[function(require,module,exports) {
function n(n,r){(null==r||r>n.length)&&(r=n.length);for(var e=0,l=new Array(r);e<r;e++)l[e]=n[e];return l}module.exports=n;
},{}],"Vzqv":[function(require,module,exports) {
var r=require("./arrayLikeToArray");function t(t,e){if(t){if("string"==typeof t)return r(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(o):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?r(t,e):void 0}}module.exports=t;
},{"./arrayLikeToArray":"LGpM"}],"sa4T":[function(require,module,exports) {
function e(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}module.exports=e;
},{}],"xkYc":[function(require,module,exports) {
var r=require("./arrayWithHoles"),e=require("./iterableToArrayLimit"),t=require("./unsupportedIterableToArray"),i=require("./nonIterableRest");function u(u,a){return r(u)||e(u,a)||t(u,a)||i()}module.exports=u;
},{"./arrayWithHoles":"dEOc","./iterableToArrayLimit":"RonT","./unsupportedIterableToArray":"Vzqv","./nonIterableRest":"sa4T"}],"kUj2":[function(require,module,exports) {
function n(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}module.exports=n;
},{}],"dMjH":[function(require,module,exports) {
function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function r(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}module.exports=r;
},{}],"x3DH":[function(require,module,exports) {
function e(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}module.exports=e;
},{}],"wSXC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makePlainCode=f,exports.codeConvert=d,exports.Joint=exports.Tube=exports.Valve=void 0;var t=i(require("@babel/runtime/helpers/classCallCheck")),n=i(require("@babel/runtime/helpers/createClass")),r=require("./stack"),e=require("./instr");function i(t){return t&&t.__esModule?t:{default:t}}var a=new Set(["IF","IF_LEFT","IF_NONE","IF_CONS","LOOP","LOOP_LEFT","ITER"]),s=new Set(["LOOP","LOOP_LEFT"]),u=function(){function r(n,e,i,a){(0,t.default)(this,r),this.start={stack:i,node:n},this.cursors=[{stack:i,node:n}],this.id_mapping=e,this.max_id=a,this.applied_parts=new Set}return(0,n.default)(r,[{key:"setStack",value:function(t){this.start.stack=t,this.cursors=[{stack:t,node:this.start.node}]}},{key:"getPaths",value:function(t){var n=this,r=[];return function t(e,i){e instanceof o&&s.has(e.t)&&i.reduce(function(t,n){return n===e.id?t+1:t},0)>2||(e.parents.length?e.parents.forEach(function(r){var e=i.slice();e.unshift(r),t(n.id_mapping[r],e)}):r.push(i))}(t,[t.id]),r}},{key:"flowByPath",value:function(t){var n=this,r={},e=this.start.stack;return t.forEach(function(i,a){var s=n.id_mapping[i],u=s.flow(e,t[a+1]);r[s.id]=u instanceof Array?u.map(function(t){return t.stack}):u.stack,e=u.stack}),r}},{key:"flow",value:function(){for(var t=[],n=[],r=[],e=this.cursors;e.length;){var i=this.flowOnce(e),a=i.next_cursors,u=i.stack_mem,c=i.end_stacks,f=i.fail_stacks;n=n.concat(c),t=t.concat(f),Object.keys(u).length&&r.push(u),e=a.filter(function(t){var n=t.node,r=t.stack;return!r.is_dead&&!(n instanceof o&&s.has(n.t)&&r.path.reduce(function(t,r){return n&&r===n.id?t+1:t},0)>1)})}return{steps:r,ends:n,fails:t}}},{key:"flowOnce",value:function(t){var n=[],r={},e=[],i=[];return t.forEach(function(t){if(t.node){var a=t.node,s=a.flow(t.stack);r[a.id]=(r[a.id]||[]).concat(s instanceof Array?s.map(function(t){return t.stack}):s.stack);var u=(s instanceof Array?s:[s]).filter(function(t){return t.stack.isFailed()?(i.push(t.stack),!1):!(!t.node||0===t.node.id)||(e.push(t.stack),!1)});n=n.concat(u)}}),{next_cursors:n,stack_mem:r,end_stacks:e,fail_stacks:i}}}]),r}();exports.Valve=u;var c=function(){function r(n,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;(0,t.default)(this,r),this.id=n,this.code=e,this.next=i,this.parents=a?[a]:[]}return(0,n.default)(r,[{key:"addParent",value:function(t){this.parents.push(t)}},{key:"flow",value:function(t){var n=this,r=[t.clone()];this.code.forEach(function(t){if(!(t.prim in e.instr_mapping))throw"unhandled code instr in Tube: ".concat(t.prim);"EXEC"===t.prim?r=r.reduce(function(n,r){return n.concat(e.instr_mapping[t.prim](r,t))},[]):r.forEach(function(n){return e.instr_mapping[t.prim](n,t)})});var i=function(t){return t.path.push(n.id),{node:n.next,stack:t}};return 1===r.length?i(r[0]):r.map(function(t){return i(t)})}}]),r}();exports.Tube=c;var o=function(){function r(n,e,i){(0,t.default)(this,r),this.id=n,this.t=e,this.parents=[],this.nexts=i}return(0,n.default)(r,[{key:"addParent",value:function(t){this.parents.push(t)}},{key:"flow",value:function(t,n){var r=this;if(t=t.clone(),this.t in e.instr_mapping){var i=e.instr_mapping[this.t](t).map(function(t,n){return t.path.push(r.id),{node:r.nexts[n],stack:t}});return n?i.find(function(t){return n===t.node.id}):i}throw"unhandled code instr in Joint: ".concat(this.t)}}]),r}();function f(t){if(!(t instanceof Array))return t;var n=[];return t.forEach(function(t){if(t instanceof Array)f(t).forEach(function(t){return n.push(t)});else if("DIP"===t.prim){var r=t.args[0].int?t.args.shift().int:"1";n.push({prim:"CURSOR",args:[{int:r}]}),f(t.args[0]).forEach(function(t){return n.push(t)}),n.push({prim:"CURSOR",args:[{int:"-"+r}]})}else t.prim&&t.args?(t.args=t.args.map(function(t){return f(t)}),n.push(t)):n.push(t)}),n}function d(t,n){var e=n||1,i={};try{t=f(JSON.parse(JSON.stringify(t)))}catch(h){throw"Invalid code body"}return{tube:function t(n,f){for(var h=[],p=0;p<n.length;p++){if("LAMBDA"===n[p].prim){var l=d(n[p].args[2],e+1),v=new u(l.tube,l.id_mapping,new r.Stack,l.id);n[p].args[2]=v}if(a.has(n[p].prim)){var k=t(n.slice(p+1),f),m=new o(e++,n[p].prim,[]),g=t(n[p].args[0],s.has(n[p].prim)?m:k),_=n[p].args.length>1?t(n[p].args[1],k):k;m.nexts=[g,_],i[m.id]=m,g.addParent(m.id),_.addParent(m.id);var w=new c(e++,h,m);return i[w.id]=w,m.addParent(w.id),w}h.push(n[p])}if(h.length||f){f=h.length&&"FAILWITH"===h[h.length-1].prim?void 0:f;var y=new c(e++,h,f);return i[y.id]=y,f&&f.addParent(y.id),y}return new c(0,[])}(t),id_mapping:i,id:e-1}}exports.Joint=o;
},{"@babel/runtime/helpers/classCallCheck":"kUj2","@babel/runtime/helpers/createClass":"dMjH","./stack":"aiKH","./instr":"QtXH"}],"QtXH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.instr_mapping=exports.get_t=void 0;var t,n=o(require("@babel/runtime/helpers/defineProperty")),e=o(require("@babel/runtime/helpers/slicedToArray")),a=require("./micheline"),r=require("./stack"),u=require("./tube");function o(t){return t&&t.__esModule?t:{default:t}}var i=function(t){return t instanceof Array?t:[t]};exports.get_t=i;var l=(t={DEBUGGER:function(t,n){},CURSOR:function(t,n){t.cursor+=parseInt(n.args[0].int)},DUP:function(t,n){t.insert(t.top().clone())},CAR:function(t,n){t.replace(function(t){return t.instr?new r.StackItem(i(t.t[1]),n.annots,n.prim,null,[t]):t.subs[0]})},CDR:function(t,n){t.replace(function(t){return t.instr?new r.StackItem(i(t.t[2]),n.annots,n.prim,null,[t]):t.subs[1]})},ITER:function(t){var n=t.drop(1),a=(0,e.default)(n,1)[0],u=t.clone();return t.insert(new r.StackItem(i(a.t[1]),[],"ITER.EACH",null,[a])),[t,u]},LOOP:function(t){var n=t.drop(1),a=((0,e.default)(n,1)[0],t.clone());return[t,a]},LOOP_LEFT:function(t){var n=t.drop(1),a=(0,e.default)(n,1)[0],u=t.clone();return t.insert(new r.StackItem(i(a.t[1]),[],"LOOP_LEFT.LEFT",null,[a])),u.insert(new r.StackItem(i(a.t[2]),[],"LOOP_LEFT.RIGHT",null,[a])),t.setDeadFlag("LOOP_LEFT.0",a),u.setDeadFlag("LOOP_LEFT.1",a),[t,u]},IF_NONE:function(t){var n=t.drop(1),a=(0,e.default)(n,1)[0],u=t.clone();return u.insert(new r.StackItem(i(a.t[1]),[],"IF_NONE.SOME",null,[a])),t.setDeadFlag("IF_NONE.0",a),u.setDeadFlag("IF_NONE.1",a),[t,u]},IF_CONS:function(t){var n=t.drop(1),a=(0,e.default)(n,1)[0],u=t.clone();return t.insert(new r.StackItem(a.t,[],"IF_CONS.REST",null,[a])),t.insert(new r.StackItem(i(a.t[1]),[],"IF_CONS.HEAD",null,[a])),t.setDeadFlag("IF_CONS.0",a),u.setDeadFlag("IF_CONS.1",a),[t,u]},IF_LEFT:function(t){var n=t.drop(1),a=(0,e.default)(n,1)[0],u=t.clone();return t.insert(new r.StackItem(i(a.t[1]),[],"IF_LEFT.LEFT",null,[a])),u.insert(new r.StackItem(i(a.t[2]),[],"IF_LEFT.RIGHT",null,[a])),t.setDeadFlag("IF_LEFT.0",a),u.setDeadFlag("IF_LEFT.1",a),[t,u]},IF:function(t){var n=t.drop(1),a=(0,e.default)(n,1)[0],r=t.clone();return t.setDeadFlag("IF.0",a),r.setDeadFlag("IF.1",a),[t,r]},EXEC:function(t,n){var a=t.drop(2),o=(0,e.default)(a,2),l=o[0],c=o[1];if(c.value instanceof u.Valve){t.insert(l),c.value.setStack(t),t.attached.renderValve(c.value);var s=c.value.flow(),f=s.ends,p=s.fails;return f.concat(p)}return t.insert(new r.StackItem(i(c.t[2]),n.annots,n.prim,null,[l,c])),[t]},PUSH:function(t,n){t.insert((0,a.createStackItem)(n.args[0],n.args[1]))},AMOUNT:function(t,n){t.insert(new r.StackItem(["mutez"],n.annots,"",t.env.amount,[]))},DROP:function(t,n){var e=n.args&&n.args[0].int?parseInt(n.args[0].int):1;t.drop(e)},NIL:function(t,n){t.insert(new r.StackItem(["list",(0,a.toVType)(n.args[0])],n.annots,n.prim,null,[]))},PAIR:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1];t.insert(new r.StackItem(["pair",o.t,i.t],n.annots,"",null,[o,i]))},UNIT:function(t,n){t.insert(new r.StackItem(["unit"],n.annots,"","Unit",[]))},FAILWITH:function(t,n){var e=new r.StackItem(["fail"],n.annots,"",null,t.drop(1));t.empty(),t.insert(e)},SWAP:function(t,n){var a=t.drop(2),r=(0,e.default)(a,2),u=r[0],o=r[1];t.insert(u),t.insert(o)},IMPLICIT_ACCOUNT:function(t,n){t.insert(new r.StackItem(["contract","unit"],n.annots,n.prim,null,t.drop(1)))},SENDER:function(t,n){t.insert(new r.StackItem(["address"],n.annots,"",t.env.sender,[]))},RENAME:function(t,n){t.top().annots=n.annots},INT:function(t,n){t.replace(function(t){return new r.StackItem(["int"],n.annots,n.prim,null,[t])})},NEG:function(t,n){t.replace(function(t){return new r.StackItem(["int"],n.annots,n.prim,null,[t])})},ABS:function(t,n){t.replace(function(t){return new r.StackItem(["nat"],n.annots,n.prim,null,[t])})},LSL:function(t,n){t.insert(new r.StackItem(["nat"],n.annots,n.prim,null,t.drop(2)))},LSR:function(t,n){t.insert(new r.StackItem(["nat"],n.annots,n.prim,null,t.drop(2)))},EDIV:function(t,n){var a,u,o=t.drop(2),i=(0,e.default)(o,2),l=i[0],c=i[1];"mutez"===l.t[0]?(a="nat"===c.t[0]?"mutez":"nat",u="mutez"):(a="nat"===l.t[0]&&"nat"===c.t[0]?"nat":"int",u="nat"),t.insert(new r.StackItem(["option",["pair",a,u]],n.annots,n.prim,null,[l,c]))},MUL:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1],l=new Set([o,i].map(function(t){return t.t[0]})),c=l.has("mutez")?"mutez":l.has("int")?"int":"nat";t.insert(new r.StackItem([c],n.annots,n.prim,null,[o,i]))},ADD:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1],l=new Set([o,i].map(function(t){return t.t[0]})),c=l.has("timestamp")?"timestamp":l.has("mutez")?"mutez":l.has("int")?"int":"nat";t.insert(new r.StackItem([c],n.annots,n.prim,null,[o,i]))},SUB:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1],l=new Set([o,i].map(function(t){return t.t[0]})).has("mutez")?"mutez":"timestamp"===o.t[0]?"timestamp"===i.t[0]?"int":"timestamp":"int";t.insert(new r.StackItem([l],n.annots,n.prim,null,[o,i]))},XOR:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],l=u[1];t.insert(new r.StackItem(i(o.t[0]),n.annots,n.prim,null,[o,l]))},AND:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],l=u[1];t.insert(new r.StackItem(i(l.t[0]),n.annots,n.prim,null,[o,l]))},OR:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],l=u[1];t.insert(new r.StackItem(i(o.t[0]),n.annots,n.prim,null,[o,l]))},CONS:function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],l=u[1];t.insert(new r.StackItem(i(l.t),n.annots,n.prim,null,[o,l]))}},(0,n.default)(t,"NIL",function(t,n){t.insert(new r.StackItem(["list",(0,a.toVType)(n.args[0])],n.annots,n.prim,null,[]))}),(0,n.default)(t,"PAIR",function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1];t.insert(new r.StackItem(["pair",o.t,i.t],n.annots,"",null,[o,i]))}),(0,n.default)(t,"SOME",function(t,n){t.replace(function(t){return new r.StackItem(["option",t.t],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"NONE",function(t,n){t.insert(new r.StackItem(["option",(0,a.toVType)(n.args[0])],n.annots,n.prim,null,[]))}),(0,n.default)(t,"MAP",function(t,n){var a=t.drop(1),u=(0,e.default)(a,1)[0];t.insert(new r.StackItem(i(u.t),n.annots,n.prim,null,[u]))}),(0,n.default)(t,"DIG",function(t,n){var e=parseInt(n.args[0].int);t.insert(t.dropAt(e))}),(0,n.default)(t,"DUG",function(t,n){var a=parseInt(n.args[0].int),r=t.drop(1),u=(0,e.default)(r,1)[0];t.insertAt(a,u)}),(0,n.default)(t,"NOW",function(t,n){t.insert(new r.StackItem(["timestamp"],n.annots,"",t.env.now,[]))}),(0,n.default)(t,"COMPARE",function(t,n){t.insert(new r.StackItem(["int"],n.annots,n.prim,null,t.drop(2)))}),(0,n.default)(t,"EQ",function(t,n){t.replace(function(t){return new r.StackItem(["bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"NEQ",function(t,n){t.replace(function(t){return new r.StackItem(["bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"GT",function(t,n){t.replace(function(t){return new r.StackItem(["bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"GE",function(t,n){t.replace(function(t){return new r.StackItem(["bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"LE",function(t,n){t.replace(function(t){return new r.StackItem(["bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"LT",function(t,n){t.replace(function(t){return new r.StackItem(["bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"AMOUNT",function(t,n){t.insert(new r.StackItem(["mutez"],n.annots,"",t.env.amount,[]))}),(0,n.default)(t,"BALANCE",function(t,n){t.insert(new r.StackItem(["mutez"],n.annots,"",t.env.balance,[]))}),(0,n.default)(t,"SELF",function(t,n){t.insert(new r.StackItem(["contract",t.attached.parameter_vtype],n.annots,"",t.env.self,[]))}),(0,n.default)(t,"CHAIN_ID",function(t,n){t.insert(new r.StackItem(["chain_id"],n.annots,"",t.env.chain_id,[]))}),(0,n.default)(t,"TRANSFER_TOKENS",function(t,n){t.insert(new r.StackItem(["operation"],n.annots,n.prim,null,t.drop(3)))}),(0,n.default)(t,"PACK",function(t,n){t.replace(function(t){return new r.StackItem(["bytes"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"UNPACK",function(t,n){t.replace(function(t){return new r.StackItem(["option",(0,a.toVType)(n.args[0])],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"CHECK_SIGNATURE",function(t,n){t.insert(new r.StackItem(["bool"],n.annots,n.prim,null,t.drop(3)))}),(0,n.default)(t,"APPLY",function(t,n){var r=t.drop(2),o=(0,e.default)(r,2),i=o[0],l=o[1];if(!(l.value instanceof u.Valve))throw"APPLY / invalid lambda value: ".concat(l.value);l.value.applied_parts.has(n)||(l.value.applied_parts.add(n),(l.value.cursors[0].node instanceof u.Tube?[l.value.cursors[0].node]:l.value.cursors[0].node.nexts).forEach(function(t){t.code.unshift({prim:"PAIR"}),t.code.unshift({prim:"PUSH",args:[(0,a.fallbackType)(i.t),i]})}));t.insert(l)}),(0,n.default)(t,"LAMBDA",function(t,n){t.insert(new r.StackItem(["lambda",(0,a.toVType)(n.args[0]),(0,a.toVType)(n.args[1])],n.annots,"",n.args[2],[]))}),(0,n.default)(t,"CONCAT",function(t,n){var a=t.drop(1),u=(0,e.default)(a,1)[0];if("list"===u.t[0])t.insert(new r.StackItem(i(u.t[1]),n.annots,n.prim,null,[u]));else{var o=t.drop(1),l=(0,e.default)(o,1)[0];t.insert(new r.StackItem(i(u.t[0]),n.annots,n.prim,null,[u,l]))}}),(0,n.default)(t,"CONTRACT",function(t,n){var u=t.drop(1),o=(0,e.default)(u,1)[0];t.insert(new r.StackItem(["option",["contract",(0,a.toVType)(n.args[0])]],n.annots,"",null,[o]))}),(0,n.default)(t,"STEPS_TO_QUOTA",function(t,n){t.insert(new r.StackItem(["nat"],n.annots,"","STEPS_TO_QUOTA",[]))}),(0,n.default)(t,"CREATE_ACCOUNT",function(t,n){var e=t.drop(4);t.insert(new r.StackItem(["address"],n.annots,n.prim+"_ADDR",null,e)),t.insert(new r.StackItem(["operation"],n.annots,n.prim,null,e))}),(0,n.default)(t,"CREATE_CONTRACT",function(t,n){var e="key_hash"===t.top().t[0]?t.drop(5):t.drop(3),a=5===e.length?"LEGACY_CREATE_CONTRACT":"CREATE_CONTRACT";t.insert(new r.StackItem(["address"],n.annots,a+"_ADDR",null,e)),t.insert(new r.StackItem(["operation"],n.annots,a,null,e))}),(0,n.default)(t,"MEM",function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1];t.insert(new r.StackItem(["bool"],n.annots,n.prim,null,[o,i]))}),(0,n.default)(t,"GET",function(t,n){var a=t.drop(2),u=(0,e.default)(a,2),o=u[0],i=u[1];t.insert(new r.StackItem(["option",i.t[2]],n.annots,n.prim,null,[o,i]))}),(0,n.default)(t,"UPDATE",function(t,n){var a=t.drop(3),u=(0,e.default)(a,3),o=u[0],i=u[1],l=u[2];t.insert(new r.StackItem(l.t,n.annots,n.prim,null,[o,i,l]))}),(0,n.default)(t,"LEFT",function(t,n){var u=t.drop(1),o=(0,e.default)(u,1)[0];t.insert(new r.StackItem(["or",o.t,(0,a.toVType)(n.args[0])],n.annots,n.prim,null,[o]))}),(0,n.default)(t,"RIGHT",function(t,n){var u=t.drop(1),o=(0,e.default)(u,1)[0];t.insert(new r.StackItem(["or",(0,a.toVType)(n.args[0]),o.t],n.annots,n.prim,null,[o]))}),(0,n.default)(t,"EMPTY_SET",function(t,n){t.insert(new r.StackItem(["set",(0,a.toVType)(n.args[0])],n.annots,"",null,[]))}),(0,n.default)(t,"EMPTY_BIG_MAP",function(t,n){t.insert(new r.StackItem(["big_map",(0,a.toVType)(n.args[0]),(0,a.toVType)(n.args[1])],n.annots,"",null,[]))}),(0,n.default)(t,"EMPTY_MAP",function(t,n){t.insert(new r.StackItem(["map",(0,a.toVType)(n.args[0]),(0,a.toVType)(n.args[1])],n.annots,"",null,[]))}),(0,n.default)(t,"SHA256",function(t,n){t.replace(function(t){return new r.StackItem(["bytes"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"SHA512",function(t,n){t.replace(function(t){return new r.StackItem(["bytes"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"BLAKE2B",function(t,n){t.replace(function(t){return new r.StackItem(["bytes"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"HASH_KEY",function(t,n){t.replace(function(t){return new r.StackItem(["key_hash"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"ADDRESS",function(t,n){t.replace(function(t){return new r.StackItem(["address"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"SOURCE",function(t,n){t.insert(new r.StackItem(["address"],n.annots,"",t.env.source,[]))}),(0,n.default)(t,"SENDER",function(t,n){t.insert(new r.StackItem(["address"],n.annots,"",t.env.sender,[]))}),(0,n.default)(t,"ISNAT",function(t,n){t.replace(function(t){return new r.StackItem(["option","bool"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"SET_DELEGATE",function(t,n){t.replace(function(t){return new r.StackItem(["operation"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"SIZE",function(t,n){t.replace(function(t){return new r.StackItem(["nat"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"NOT",function(t,n){t.replace(function(t){return new r.StackItem(["int"],n.annots,n.prim,null,[t])})}),(0,n.default)(t,"SLICE",function(t,n){var a=t.drop(3),u=(0,e.default)(a,3),o=u[0],i=u[1],l=u[2];t.insert(new r.StackItem(["option",l.t],n.annots,n.prim,null,[o,i,l]))}),(0,n.default)(t,"CAST",function(t,n){t.top().t=(0,a.toVType)(n.args[0])}),t);exports.instr_mapping=l;
},{"@babel/runtime/helpers/defineProperty":"x3DH","@babel/runtime/helpers/slicedToArray":"xkYc","./micheline":"ez1c","./stack":"aiKH","./tube":"wSXC"}],"RVdp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tToString=o,exports.instr_mapping=exports.type_mapping=void 0;var t=require("./stack"),n=require("./instr");function r(t){return"".concat(t.instr,"(").concat(t.subs.map(function(t){return t.toString()}).join(", "),")")}function o(t){return"string"==typeof t?t:"".concat(t[0].toString())+(t.length>1?"<".concat(t.slice(1).map(function(t){return"string"==typeof t?t:o(t)}).join(", "),">"):"")}var i={fail:function(t){var n=t.getSub({index:0});return"FAILWITH: ".concat(n?n.toString():"")},pair:function(t){return"(".concat(t.subs[0].toString(),", ").concat(t.subs[1].toString(),")")}};exports.type_mapping=i;var u={"IF_NONE.SOME":function(t){var o=t.getSub({index:0});return o?(o.t=(0,n.get_t)(o.t[1]),o.toString()):r(t)},"IF_LEFT.LEFT":function(t){return"(".concat(t.subs[0].toString(),").left")},"IF_LEFT.RIGHT":function(t){return"(".concat(t.subs[0].toString(),").right")},"Left|Right":function(t){return"(".concat(t.subs[0].toString()," | ").concat(t.subs[1].toString(),")")},COMPARE_BASE:function(t,n){var o=t.getSub({index:0,instr:"COMPARE"});return o?"".concat(o.subs[0].toString()," ").concat(n," ").concat(o.subs[1].toString()):r(t)},EQ:function(t){return u.COMPARE_BASE(t,"==")},NEQ:function(t){return u.COMPARE_BASE(t,"!=")},GE:function(t){return u.COMPARE_BASE(t,">=")},LE:function(t){return u.COMPARE_BASE(t,"<=")},GT:function(t){return u.COMPARE_BASE(t,">")},LT:function(t){return u.COMPARE_BASE(t,"<")},ADD:function(t){return"(".concat(t.subs[0].toString()," + ").concat(t.subs[1].toString(),")")},MUL:function(t){return"".concat(t.subs[0].toString()," * ").concat(t.subs[1].toString())},EDIV:function(t){return"".concat(t.subs[0].toString()," / ").concat(t.subs[1].toString())},NIL:function(t){return"[]"},CONS:function(t){return t.getSub({index:1,instr:"NIL"})?"[".concat(t.subs[0].toString(),"]"):r(t)}};exports.instr_mapping=u;
},{"./stack":"aiKH","./instr":"QtXH"}],"aiKH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StackItem=exports.Stack=void 0;var t=s(require("@babel/runtime/helpers/slicedToArray")),i=s(require("@babel/runtime/helpers/classCallCheck")),n=s(require("@babel/runtime/helpers/createClass")),e=require("./repr"),r=require("./instr");function s(t){return t&&t.__esModule?t:{default:t}}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{self:"SELF",now:"NOW",source:"SOURCE",sender:"SENDER",chain_id:"CHAIN_ID",amount:"AMOUNT",balance:"BALANCE"},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};(0,i.default)(this,e),this.cursor=t,this.items=n,this.path=r,this.env=s,this.attached=u,this.is_dead=!1}return(0,n.default)(e,[{key:"toStringLst",value:function(){return this.items.map(function(t){return t.reduceSelf().toString()})}},{key:"at",value:function(t){return this.items[t]}},{key:"top",value:function(){return this.items[this.cursor]}},{key:"replace",value:function(t){this.items[this.cursor]=t(this.items[this.cursor])}},{key:"topn",value:function(t){return this.items.slice(this.cursor,this.cursor+t)}},{key:"drop",value:function(t){return this.items.splice(this.cursor,t)}},{key:"dropAt",value:function(i){var n=this.items.splice(this.cursor+i,1),e=(0,t.default)(n,1)[0];if(!e)throw"dropAt / error when stack drops element at index:".concat(i);return e}},{key:"insert",value:function(t){this.items.splice(this.cursor,0,t)}},{key:"insertAt",value:function(t,i){this.items.splice(this.cursor+t,0,i)}},{key:"empty",value:function(){this.cursor=0,this.items=[]}},{key:"isFailed",value:function(){return!(!this.items[0]||"fail"!==this.items[0].t[0])}},{key:"clone",value:function(){return new e(this.cursor,this.items.map(function(t){return t.clone()}),this.path.slice(),this.env,this.attached)}},{key:"setDeadFlag",value:function(t,i){var n={"IF_LEFT.0":function(){if("Right"===i.instr)return!0},"IF_LEFT.1":function(){if("Left"===i.instr)return!0},"LOOP_LEFT.0":function(){if("Right"===i.instr)return!0},"LOOP_LEFT.1":function(){if("Left"===i.instr)return!0},"IF_NONE.0":function(){if("Some"===i.instr)return!0},"IF_NONE.1":function(){if("None"===i.instr)return!0},"IF.0":function(){if(!e.checkCondBool(i))return!0},"IF.1":function(){if(e.checkCondBool(i))return!0},"IF_CONS.0":function(){if(!i.instr&&!i.subs.length)return!0},"IF_CONS.1":function(){if(!i.instr&&i.subs.length)return!0}};if(!this.top())throw"empty stack top";if(!(t in n))throw"unhandled checking instr: ".concat(t);n[t].call(this)&&(this.is_dead=!0)}}],[{key:"checkCondBool",value:function(t){return!0}}]),e}();exports.Stack=u;var o=function(){function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(0,i.default)(this,t),this.t=n,this.annots=e,this.instr=r,this.value=s,this.subs=u}return(0,n.default)(t,[{key:"toString",value:function(){return(this.annots.length?"#".concat(this.annots[0],"#"):"")+(this.instr in e.instr_mapping?e.instr_mapping[this.instr](this):!this.instr&&this.t[0].toString()in e.type_mapping?e.type_mapping[this.t[0].toString()](this):"string"==typeof this.value&&this.value?this.value:this.instr&&this.subs.length?"".concat(this.instr,"(").concat(this.subs.map(function(t){return t.toString()}).join(", "),")"):(0,e.tToString)(this.t))}},{key:"clone",value:function(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new t(this.t,this.annots,this.instr,this.value,i?[]:this.subs.map(function(t){return t.clone()}))}},{key:"reduceSelf",value:function(){var t=this.clone(!0),i={"IF_LEFT.LEFT":function(t){return t.getSub({index:0,instr:"Left"},{index:0})||t.getSub({index:0,instr:"Left|Right"},{index:0})||t},"IF_LEFT.RIGHT":function(t){return t.getSub({index:0,instr:"Right"},{index:0})||t.getSub({index:0,instr:"Left|Right"},{index:1})||t},CAR:function(t){return t.getSub({index:0,t:"pair",instr:""},{index:0,count:2})||t},CDR:function(t){return t.getSub({index:0,t:"pair",instr:""},{index:1,count:2})||t},"IF_NONE.SOME":function(t){return t.getSub({index:0,instr:"Some",t:"option"},{index:0})||t.getSub({index:0,instr:"SOME",t:"option"},{index:0})||t}};return t.subs=this.subs.map(function(t){return t.reduceSelf()}),this.instr in i?i[this.instr](t):t}},{key:"getSub",value:function(){for(var t=this,i=0;i<arguments.length;i++){var n=i<0||arguments.length<=i?void 0:arguments[i],e=n.t,r=n.instr,s=n.index,u=n.count;if(u&&t.subs.length!==u)return null;var o=t.subs[s];if(e&&o.t[0]!==e)return null;if(void 0!==r&&o.instr!==r)return null;t=o}return t}}]),t}();exports.StackItem=o;
},{"@babel/runtime/helpers/slicedToArray":"xkYc","@babel/runtime/helpers/classCallCheck":"kUj2","@babel/runtime/helpers/createClass":"dMjH","./repr":"RVdp","./instr":"QtXH"}],"ez1c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fallbackType=n,exports.toVType=i,exports.settingInstrID=e,exports.createStackItem=a,exports.mockData=s;var r=require("./stack"),t={int:new Set(["int","nat","mutez","timestamp"]),string:new Set(["string","key_hash","address","chain_id"]),bytes:new Set(["bytes","key","signature"])};function n(r){if("string"==typeof r)return{prim:r};var t="string"==typeof r[0]?r[0]:"";return r.length>1?{prim:t,args:r.slice(1).map(function(r){return n(r)})}:{prim:t}}function i(r){return r.args instanceof Array?[r.prim].concat(r.args.map(function(r){return i(r)})):[r.prim]}function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"G",n=1,i=new Set(["pair","or"]);return function r(e){e.annots.length||i.has(e.t[0])||e.annots.push(t+n++),e.subs.forEach(function(t){return r(t)})}(r),r}function a(t,n){var e=i(t),s=n.annots?n.annots:t.annots||[];if(!t.args)return"unit"===t.prim||"bool"===t.prim?new r.StackItem(e,s,"",n.prim,[]):new r.StackItem(e,s,"",Object.values(n)[0],[]);var m=t.args[0],p=t.args[1];if("pair"===t.prim)return new r.StackItem(e,s,"",null,[a(m,n.args[0]),a(p,n.args[1])]);if("or"===t.prim)return new r.StackItem(e,s,n.prim,null,"Left"===n.prim?[a(m,n.args[0])]:"Right"===n.prim?[a(p,n.args[0])]:[a(m,n.args[0]),a(p,n.args[1])]);if("list"===t.prim||"set"===t.prim)return new r.StackItem(e,s,"",null,n.map(function(r){return a(m,r)}));if("map"===t.prim||"big_map"===t.prim)return new r.StackItem(e,s,"",null,n.map(function(t){return new r.StackItem(["elt"],t.annots||s,"",null,[a(m,t.args[0]),a(p,t.args[1])])}));if("option"===t.prim)return new r.StackItem(e,s,n.prim,null,"Some"===n.prim?[a(m,n.args[0])]:[]);if("contract"===t.prim)return new r.StackItem(e,s,"",n.string,[]);if("lambda"===t.prim){var u=n instanceof Array?n:n.args[2];return new r.StackItem(e,s,"",u,[])}throw"createStackItem / invalid t: ".concat(t.prim," v: ").concat(n.prim)}function s(r){if(r.args){var n=r.args[0],i=r.args[1];if("pair"===r.prim)return{prim:"Pair",args:[s(n),s(i)]};if("or"===r.prim)return{prim:"Left|Right",args:[s(n),s(i)]};if("list"===r.prim||"set"===r.prim)return[s(n)];if("map"===r.prim||"big_map"===r.prim)return[{prim:"Elt",args:[s(n),s(i)]}];if("option"===r.prim)return{prim:"Some|None",args:[s(r.args[0])]};if("contract"===r.prim)return{string:""};if("lambda"===r.prim)return[{prim:"RENAME",annots:[""]}]}else{if(t.int.has(r.prim))return{int:""};if(t.string.has(r.prim))return{string:""};if(t.bytes.has(r.prim))return{bytes:""};if("unit"===r.prim)return{prim:"Unit"};if("bool"===r.prim)return{prim:"True|False"}}throw"mockData / invalid Micheline type: ".concat(r.prim)}
},{"./stack":"aiKH"}],"JN0q":[function(require,module,exports) {
"use strict";function t(t,e){return void 0===e?JSON.parse(window.localStorage.getItem(t)):window.localStorage.setItem(t,JSON.stringify(e))}function e(t){var e=+new Date;return function(){var r=+new Date;if(r>e+1e3/60)return e=r,t.apply(this,arguments)}}function r(t){var e=location.hash.slice(1).split("&").map(function(t){return t.split("=")}),r={};return e.forEach(function(t){return r[t[0]]=t[1]}),r[t]}Object.defineProperty(exports,"__esModule",{value:!0}),exports.local=t,exports.throttle=e,exports.getQuery=r;
},{}],"o3SL":[function(require,module,exports) {
var r=require("./arrayLikeToArray");function a(a){if(Array.isArray(a))return r(a)}module.exports=a;
},{"./arrayLikeToArray":"LGpM"}],"lZpU":[function(require,module,exports) {
function e(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}module.exports=e;
},{}],"NCaH":[function(require,module,exports) {
function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}module.exports=e;
},{}],"I9dH":[function(require,module,exports) {
var r=require("./arrayWithoutHoles"),e=require("./iterableToArray"),u=require("./unsupportedIterableToArray"),a=require("./nonIterableSpread");function o(o){return r(o)||e(o)||u(o)||a()}module.exports=o;
},{"./arrayWithoutHoles":"o3SL","./iterableToArray":"lZpU","./unsupportedIterableToArray":"Vzqv","./nonIterableSpread":"NCaH"}],"TdyB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.distance=l,exports.TextBlock=exports.Text=exports.AutoCurve=exports.CustomCurve=exports.Polyline=exports.Curve=exports.Arrow=exports.Rect=exports.Line=exports.JointGraph=exports.TubeGraph=exports.linearGradient=exports.Graph=void 0;var t=r(require("@babel/runtime/helpers/toConsumableArray")),e=r(require("@babel/runtime/helpers/classCallCheck")),n=r(require("@babel/runtime/helpers/createClass"));function r(t){return t&&t.__esModule?t:{default:t}}var o=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.style.width="0",t.style.height="0",t.style.border="0",t.style.padding="0",document.body&&document.body.appendChild(t),function(e){return t.appendChild(e),e.getBBox()}}(),i=function(t){var e=o(t),n=e.x+e.width/2,r=e.y+e.height/2;return[[n,e.y],[e.x+e.width,r],[n,e.y+e.height],[e.x,r]]};function a(t){var e=t.split(/[\s,]+/);if(2!==e.length)throw"invalid svg point: ".concat(t);var n=e.map(function(e){var n=parseInt(e);if(isNaN(n))throw"invalid svg point: ".concat(t);return n});return[n[0],n[1]]}function s(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}function u(t){return"".concat(t[0]," ").concat(t[1])}function c(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r={up:[0,-n],down:[0,n],left:[-n,0],right:[n,0]}[e];return[t[0]+r[0],t[1]+r[1]]}function l(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2);return n?Math.sqrt(r):r}function p(t,e,n){var r=Number.MAX_SAFE_INTEGER,o=[];return t.forEach(function(t,i){e.forEach(function(e,a){if(n&&(!n.has(i)||!n.has(a)))return!1;var s=l(t,e,!1);s<r&&(r=s,o=[i,a])})}),{last_d:r,index1:o[0],index2:o[1]}}var h=function(){function t(n){var r=this;(0,e.default)(this,t),n instanceof Array?(this.kind="g",this.el=document.createElementNS("http://www.w3.org/2000/svg","g"),n.forEach(function(t){return r.el.appendChild(t.el)})):(this.kind=n,this.el=document.createElementNS("http://www.w3.org/2000/svg",n))}return(0,n.default)(t,[{key:"setAttrs",value:function(t){for(var e in t)this.el.setAttribute(e,t[e])}},{key:"setStyles",value:function(t){for(var e in t)this.el.style[e]=t[e]}},{key:"getAttr",value:function(t){return this.el.getAttribute(t)}},{key:"width",value:function(){return this.key_points[1][0]-this.key_points[3][0]}},{key:"height",value:function(){return this.key_points[2][1]-this.key_points[0][1]}},{key:"relocate",value:function(t){var e=this.key_points[3][0],n=this.key_points[0][1];this.setAttrs({transform:"translate(".concat(t[0]-e,", ").concat(t[1]-n,")")}),this.key_points.forEach(function(r){r[0]+=t[0]-e,r[1]+=t[1]-n})}},{key:"append",value:function(t){this.el.appendChild(t)}},{key:"modClass",value:function(t,e){var n=this.el.getAttribute("class")||"",r=new Set(n.split(/\s+/g));"add"===e?r.add(t):r.delete(t),this.el.setAttribute("class",Array.from(r).join(" "))}},{key:"addClass",value:function(t){this.modClass(t,"add")}},{key:"removeClass",value:function(t){this.modClass(t,"remove")}},{key:"on",value:function(t,e){this.addClass("cursor-pointer"),this.el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.removeClass("cursor-pointer"),this.el.removeEventListener(t,e)}},{key:"show",value:function(){this.el.removeAttribute("display")}},{key:"hide",value:function(){this.el.setAttribute("display","none")}},{key:"toggle",value:function(){this.el.getAttribute("display")?this.show():this.hide()}}]),t}();exports.Graph=h;var d=function(t,e){var n=new h("linearGradient");return n.setAttrs(e),t.forEach(function(t){var e=new h("stop");e.setAttrs(t),n.el.appendChild(e.el)}),n};exports.linearGradient=d;var v=function(t){var e=g([0,0],16,8),n=g([0,10],16,8),r=new h([e,n].concat(t?_([16,0],t,.8):[]));return r.key_points=[[8,0],[16,5],[8,10],[0,5]],r.addClass("tube"),{graph:r,end_offset:[0,18]}};exports.TubeGraph=v;var f=function(e,n){var r=8*e+2*(e-1),o=g([0,0],r,8),i=(0,t.default)(Array(e)).map(function(t,e){return[0+10*e,10]}),a=i.map(function(t){return g(t,8,8)}),s=new h(a.concat(o,n?_([r,0],n,.8):[]));return s.key_points=[[r/2,0],[r,9],[r/2,18],[0,9]],s.addClass("joint"),{graph:s,end_offsets:i.map(function(t){return[t[0]-0-r/2+4,t[1]-0+8]})}};exports.JointGraph=f;var y=function(t,e){var n=new h("line");return n.setAttrs({x1:t[0],y1:t[1],x2:e[0],y2:e[1],stroke:"black"}),n};exports.Line=y;var g=function(t,e,n,r){var o=new h("rect");return o.setAttrs(Object.assign({x:t[0],y:t[1],width:e,height:n},r)),o.addClass("rect"),o};exports.Rect=g;var x=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.6,o=new h("path"),i=n*r,a={up:function(){return[[t[0]-i,t[1]-n],[t[0]+i,t[1]-n]]},down:function(){return[[t[0]-i,t[1]+n],[t[0]+i,t[1]+n]]},left:function(){return[[t[0]-n,t[1]+i],[t[0]-n,t[1]-i]]},right:function(){return[[t[0]+n,t[1]-i],[t[0]+n,t[1]+i]]}}[e](),s={up:function(){return[t[0],t[1]-i]},down:function(){return[t[0],t[1]+i]},left:function(){return[t[0]-i,t[1]]},right:function(){return[t[0]+i,t[1]]}}[e]();return o.setAttrs({d:"\n      M ".concat(u(t),"\n      L ").concat(u(a[0]),"\n      L ").concat(u(s),"\n      L ").concat(u(a[1]),"\n      Z\n    ")}),o};exports.Arrow=x;var k=function(t,e,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=new h("path"),s=[u(t),u(e)],l=s[0],p=s[1],d=[u(c(t,n,o)),u(c(e,r,o))],v=d[0],f=d[1];return a.setAttrs(Object.assign({d:"\n      M ".concat(l,"\n      C ").concat(v,", ").concat(f,", ").concat(p,"\n    "),stroke:"black",fill:"transparent"},i)),a.addClass("curve"),a};exports.Curve=k;var w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new h("polyline");return n.setAttrs(Object.assign({fill:"transparent",points:t.map(function(t){return u(t)}).join(", ")},e)),n};exports.Polyline=w;var m=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=new h("path"),i=[t,[t[0],t[1]+10],[(n+t[0])/2,t[1]+10],[n,(t[1]+e[1])/2],[n,e[1]-10],[(n+e[0])/2,e[1]-10],e].map(function(t){return u(t)});return o.setAttrs(Object.assign({d:"\n      M ".concat(i[0],"\n      Q ").concat(i[1],", ").concat(i[2],"\n      T ").concat(i[3],"\n      Q ").concat(i[4],", ").concat(i[5],"\n      T ").concat(i[6],"\n    "),stroke:"black",fill:"transparent"},r)),o.addClass("custom-curve"),o};exports.CustomCurve=m;var A=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i=p(t.key_points,e.key_points,new Set([0,2])),a=["up","right","down","left"],u=t.key_points[i.index1],c=e.key_points[i.index2],l=a[i.index1],d=a[i.index2],v=k(u,c,l,d,16,o),f=175*Math.atan((c[1]-u[1])/(c[0]-u[0]))/Math.PI;if(r){var y=s(u,c),g=_(c[0]<u[0]?[y[0]-3,y[1]]:[y[0]+3,y[1]],r,.6);g.setAttrs({"text-anchor":"middle",transform:"rotate(".concat(f,", ").concat(g.getAttr("x"),", ").concat(g.getAttr("y"),")")}),v=new h([v,g])}if(n){var w=x(c,d);return new h([v,w])}return v};exports.AutoCurve=A;var _=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new h("text");return r.setAttrs({x:t[0],y:t[1]}),r.setStyles({fontSize:n+"rem"}),r.append(document.createTextNode(e)),r.key_points=i(r.el),r};exports.Text=_;var C=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=e.map(function(e,r){return _([t[0],t[1]+r*n*10],e,n)}),a=new h(o);if(a.key_points=i(a.el),r){var s=o[0].key_points[0][1],u=t[0],c=Math.max.apply(null,o.map(function(t){return t.key_points[1][0]-t.key_points[3][0]})),l=o[o.length-1].key_points[2][1]-o[0].key_points[0][1],p=g([u-10,s-10],c+20,l+20),d=new h([a,p]);return d.key_points=p.key_points,d}return a};exports.TextBlock=C;
},{"@babel/runtime/helpers/toConsumableArray":"I9dH","@babel/runtime/helpers/classCallCheck":"kUj2","@babel/runtime/helpers/createClass":"dMjH"}],"bBiC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.diffStackItem=u,exports.DiffValue=void 0;var e=r(require("@babel/runtime/helpers/classCallCheck")),t=r(require("@babel/runtime/helpers/createClass")),i=require("./stack");function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function i(t){(0,e.default)(this,i),this.direction=t}return(0,t.default)(i,[{key:"addDirection",value:function(e){this.direction!==e&&(this.direction="both")}},{key:"hasValue",value:function(){return this.left||this.right}},{key:"read",value:function(){var e=[];return this.left&&e.push(this.left.toString()),this.right&&e.length&&e.push("/"),this.right&&e.push(this.right.toString()),e.join(" ")}}]),i}();function u(e,t,i){var r=function e(t,i,r){i.value instanceof s?i.value.addDirection(r):i.value=new s(r),"Left"===t.instr?e(t.subs[0],i.subs[0],r):"Right"===t.instr?e(t.subs[0],i.subs[1],r):"pair"===t.t[0]?(e(t.subs[0],i.subs[0],r),e(t.subs[1],i.subs[1],r)):"left"===r?i.value.left=t:i.value.right=t};return r(t,e,"left"),r(i,e,"right"),e}exports.DiffValue=s;
},{"@babel/runtime/helpers/classCallCheck":"kUj2","@babel/runtime/helpers/createClass":"dMjH","./stack":"aiKH"}],"IGbE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SVGRenderer=void 0;var e=c(require("@babel/runtime/helpers/classCallCheck")),t=c(require("@babel/runtime/helpers/createClass")),n=c(require("@babel/runtime/helpers/slicedToArray")),r=require("../emu/tube"),o=require("../utils"),a=require("./graph"),i=require("../emu/diff"),s=require("../emu/stack");function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t,r){var a=e.getAttribute("viewBox").split(" ").map(function(e){return parseInt(e)}),i=(0,n.default)(a,4),s=i[0],c=i[1],u=i[2],d=i[3],l=!1,f=[0,0];e.addEventListener("mousedown",function(e){f=[e.clientX,e.clientY],l=!0}),e.addEventListener("mousemove",(0,o.throttle)(function(t){if(!l)return!1;e.setAttribute("viewBox","".concat(s+f[0]-t.clientX," ").concat(c+f[1]-t.clientY," ").concat(u," ").concat(d))}));var p=function(e){l&&(s+=f[0]-e.clientX,c+=f[1]-e.clientY),l=!1};e.addEventListener("mouseup",p),e.addEventListener("mouseleave",p),t.addEventListener("click",function(t){t.preventDefault();u<=100||d<=100||(u+=-100,d+=-100,s-=-50,c-=-50,e.setAttribute("viewBox","".concat(s," ").concat(c," ").concat(u," ").concat(d)))}),r.addEventListener("click",function(t){t.preventDefault();u+=100,d+=100,s-=50,c-=50,e.setAttribute("viewBox","".concat(s," ").concat(c," ").concat(u," ").concat(d))})}var d=function(){function n(t){(0,e.default)(this,n),this.graph_mem={},this.node_binding=t||{}}return(0,t.default)(n,[{key:"glowGraphs",value:function(e){var t=new Set(e.map(function(e){return e.toString()}));for(var n in this.graph_mem)this.graph_mem[n].removeClass("path-selected"),this.graph_mem[n].addClass("path-unselected"),t.has(n)&&this.graph_mem[n].addClass("path-selected")}},{key:"renderDiff",value:function(e){var t=[-1,-1],n={left:"red",right:"green",both:"#8B7400"},r={},o={};!function e(t,s){var c=t.value instanceof i.DiffValue&&t.value.hasValue()?t.value.read():"or"===t.t[0]?"".concat(t.annots[0]?t.annots[0]+": ":"","or"):t.toString(),u=(0,a.Text)([0,0],c,1.2);return t.value instanceof i.DiffValue&&u.setStyles({fill:n[t.value.direction]}),s in r||(r[s]=[],o[s]=[]),r[s].push(u),t.subs.forEach(function(t){o[s].push({from:u,direction:t.value instanceof i.DiffValue?t.value.direction:"",to:e(t,s+1)})}),u}(e,1);var s=Number.MAX_SAFE_INTEGER,c=0,u=[],d=function(e){var n=r[e],a=[],i=[],d=0;n.forEach(function(e,t){var n=e.key_points[1][0]-e.key_points[3][0];a.push(d),i.push(d+n/2),d+=n+20}),d>t[0]&&(t[0]=d),50*parseInt(e)>t[1]&&(t[1]=50*parseInt(e));var l=0;"1"===e?l=0:(o[parseInt(e)-1].forEach(function(e,t){var n=e.from.key_points[0][0];l+=i[t]-n}),l/=n.length),a[0]-l<s&&(s=a[0]-l),a[0]-l+d>c&&(c=a[0]-l+d),n.forEach(function(t,n){t.relocate([a[n]-l,50*(parseInt(e)-1)]),u.push(t)})};for(var l in r)d(l);for(var f in o)o[f].forEach(function(e){var t=(0,a.AutoCurve)(e.from,e.to,!0,"",e.direction?{stroke:n[e.direction]}:{});u.push(t)});return this.createSVG([0,0],new a.Graph(u).el,[s-50,-10,c-s+100,t[1]])}},{key:"renderValve",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{show_id:!0},o={},i={},s=[];!function e(t,c){if(t&&t.id&&!(t.id in o))if(c in i||(i[c]=[]),t instanceof r.Tube){var u=(0,a.TubeGraph)(n.show_id?t.id+"":"");i[c].push(Object.assign({},{node:t},u)),o[t.id]=u,s.push({from:t.id,offset:u.end_offset,to:t.next&&t.next.id}),e(t.next,c+1)}else if(t instanceof r.Joint){var d=(0,a.JointGraph)(t.nexts.length,n.show_id?t.id+"":"");i[c].push(Object.assign({},{node:t},d)),o[t.id]=d,t.nexts.forEach(function(n,r){s.push({from:t.id,offset:d.end_offsets[r],to:n.id}),e(n,c+1)})}}(e.start.node,1);var c=0,u=0,d=30,l=40,f=[],p=function(e){u+=l;var n=i[e],o=n.reduce(function(e,t){return e+t.graph.width()+d},0);c=o>c?o:c;var a=16;n.forEach(function(n,i){var s=n.graph.width();n.graph.relocate([a-o/2,parseInt(e)*l]),a+=s+d,f.push(n.graph),t.graph_mem[n.node.id]=n.graph;var c=function(e){n.graph.on(e,function(){return t.node_binding[e](n.node)})};for(var u in t.node_binding)c(u);n.node instanceof r.Tube&&(n.node.next&&n.node.next.id||n.graph.addClass("end-node"),"FAILWITH"===(n.node.code.length?n.node.code[n.node.code.length-1].prim:"")&&n.graph.addClass("fail-node"))})};for(var h in i)p(h);return s.forEach(function(e){if(e.from&&e.to){var t=o[e.from].graph.key_points[0],n=[t[0]+e.offset[0],t[1]+e.offset[1]],r=o[e.to].graph.key_points[0],i=Math.abs(n[0])>Math.abs(r[0])?n[0]:r[0],s=r[1]-n[1]!=22?(0,a.CustomCurve)(n,r,i+Math.abs(i)/i*100):(0,a.Curve)(n,r,"down","up",8);f.unshift(s)}}),this.createSVG([c+300,u+64],new a.Graph(f).el)}},{key:"createSVG",value:function(e,t,n){var r=document.createElement("div");r.className="svg-wrapper";var o=document.createElement("div");o.innerHTML="+";var i=document.createElement("div");i.innerHTML="-",[o,i].forEach(function(e){e.style.display="inline-flex",e.style.margin="4px 0 0 4px",e.style.width="16px",e.style.height="16px",e.style.justifyContent="center",e.style.alignItems="center",e.style.cursor="pointer",e.style.fontFamily="monospace",e.style.border="1px solid black"});var s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.style.width="100%";var c=new a.Graph("defs");c.el.innerHTML='\n      <linearGradient id="tubeLongConnect" gradientTransform="rotate(90)">\n        <stop offset="5%" stop-color="#aaa"></stop>\n        <stop offset="20%" stop-color="#eee"></stop>\n        <stop offset="80%" stop-color="#eee"></stop>\n        <stop offset="95%" stop-color="#aaa">\n        </stop>\n      </linearGradient>\n\n      <filter id="glow" height="130%" width="130%" filterUnits="userSpaceOnUse">\n        <feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="orange"/>\n      </filter>\n    ',s.appendChild(c.el);var d=document.createElement("style");d.innerHTML="\n      .curve {stroke: #aaa} \n      .custom-curve {stroke: url(#tubeLongConnect)}\n      .rect {stroke: transparent;}\n      .joint .rect {fill: DarkSeaGreen}\n      .end-node {fill: CornflowerBlue}\n      .fail-node {fill: FireBrick}\n      .path-unselected {opacity: 0.3; filter: none}\n      .path-selected {opacity: 1; filter: url(#glow)}\n      .cursor-pointer {cursor: pointer}\n    ",s.appendChild(d);var l=n||[-e[0]/2,0,e[0],e[1]];return s.setAttribute("viewBox",l.join(" ")),u(s,o,i),s.appendChild(t),r.appendChild(o),r.appendChild(i),r.appendChild(s),r}}]),n}();exports.SVGRenderer=d;
},{"@babel/runtime/helpers/classCallCheck":"kUj2","@babel/runtime/helpers/createClass":"dMjH","@babel/runtime/helpers/slicedToArray":"xkYc","../emu/tube":"wSXC","../utils":"JN0q","./graph":"TdyB","../emu/diff":"bBiC","../emu/stack":"aiKH"}],"GOVZ":[function(require,module,exports) {
"use strict";var e=require("../emu/micheline"),t=require("../emu/tube"),r=require("../emu/stack"),a=require("../renderer/tube"),n=require("../emu/diff"),c={getGraphRenderer:function(e){return new a.SVGRenderer(e)},createStack:function(t,a,n){var c=(0,e.createStackItem)(t.t,t.val||(0,e.mockData)(t.t)),i=(0,e.createStackItem)(a.t,a.val||(0,e.mockData)(a.t));return(0,e.settingInstrID)(c,"P"),(0,e.settingInstrID)(i,"S"),new r.Stack(0,[new r.StackItem(["pair",(0,e.toVType)(t.t),(0,e.toVType)(a.t)],[],"",null,[c,i])],[],n,{parameter_vtype:(0,e.toVType)(t.t)})},createValve:function(e,r,a){var n=(0,t.codeConvert)(e,a);return new t.Valve(n.tube,n.id_mapping,r,n.id)},diff:function(t,r,a){var c=(0,e.createStackItem)(t,(0,e.mockData)(t)),i=(0,e.createStackItem)(t,r),u=(0,e.createStackItem)(t,a);return(0,n.diffStackItem)(c,i,u)}};window.Misualizer=c;
},{"../emu/micheline":"ez1c","../emu/tube":"wSXC","../emu/stack":"aiKH","../renderer/tube":"IGbE","../emu/diff":"bBiC"}]},{},["GOVZ"], null)